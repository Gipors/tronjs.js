<%@LANGUAGE="JAVASCRIPT" CODEPAGE="65001"%>
<%
/*
 * @overview Global TronASP jScripts Loader - a tiny implementation of Promises/A+ and CommonJS contributors.
 * @copyright Copyright (c) 2014 evio studio and PJBlog5 project
 * @license   Licensed under MIT license
 *            See https://github.com/cevio/tronjs.js
 * @version   6.1.223
 */
Response.Buffer=true;Server.ScriptTimeOut=999;Session.CodePage=65001;Session.LCID=2052;var __filename=Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),__dirname=Server.MapPath("./"),require,exports,module,contrast,resolve,include;var Class,console,modules,task,fs,date,http,ajax,connect,dbo;var JSON=function(){return JSON.stringify.apply(JSON,arguments)};var readVariableType=function(B,A){if(!A){return Object.prototype.toString.call(B).toLowerCase()}else{return Object.prototype.toString.call(B).toLowerCase()==="[object "+A+"]"}};if(![].indexOf){Array.prototype.indexOf=function(A){var C=-1;for(var B=0;B<this.length;B++){if(A===this[B]){C=B;break}}return C};Array.prototype.lastIndexOf=function(A){var C=-1;for(var B=this.length-1;B>-1;B--){if(A===this[B]){C=B;break}}return C}}if(![].forEach){Array.prototype.forEach=function(B){for(var A=0;A<this.length;A++){if(typeof B==="function"){B.call(this,this[A],A)}}}}console=function(){console.log.apply(console,arguments)};console.log=function(){var A=Array.prototype.slice.call(arguments,0);Response.Write(A.join(""))};console.json=function(){console.log(JSON(arguments[0]))};console.debug=function(B){if(modules.debug){var C=date.format(new Date(),"y-m-d h:i:s"),A="["+C+"]:\r\n"+B+"\r\n\r\n";fs(contrast("/debug.log")).write(A)}};(function(){Class=function(){var C=["__constructor__","initialize"],A=arguments,B=this;var D=function(){this.__constructor__="ECM.CLASS.FACTORY";return typeof this.initialize==="function"?this.initialize.apply(this,arguments):this};this.constructor=D;this.constructor.__constructor__=this.__constructor__="ECM.CLASS";this.constructor.extend=function(E){if(E.__constructor__&&E.__constructor__==="ECM.CLASS"){if(E.prototype){for(var F in E.prototype){if(C.indexOf(F)===-1){B.constructor.prototype[F]=E.prototype[F]}}}}return B.constructor};this.constructor.toggle=function(F){if(!F){return B.constructor}if(readVariableType(F)!=="array"){F=[F]}for(var E=0;E<F.length;E++){B.constructor.extend(F[E])}return B.constructor};this.constructor.add=function(F,E){if(!E){for(var G in F){B.constructor.add(G,F[G])}}else{B.constructor.prototype[F]=E}return B.constructor};if(A.length===2){this.constructor.extend(A[0]);this.constructor.add(A[1])}else{if(A.length===1){if(A[0]&&A[0].__constructor__&&A[0].__constructor__==="ECM.CLASS"){this.constructor.extend(A[0])}else{if(typeof A[0]==="function"){this.constructor.add("initialize",A[0])}else{this.constructor.add(A[0])}}}}return this.constructor}})();(function(){var A=new Class(function(){this.debug=false;this.charset="utf-8";this.time=new Date().getTime();this.timer=function(){return(new Date().getTime())-this.time};this.exports={};this.maps={};this.host=Server.MapPath("/");this.base=this.host+""});A.add("scriptExec",function(C,B){console.log('<script language="javascript" type="text/javascript">'+("("+C.toString()+")("+JSON.stringify(B)+");")+"</script>\n")});A.add("writeCss",function(B){if(!readVariableType(B,"array")){B=[B]}B.forEach(function(C){if(C&&C.length>0){console.log('<link rel="stylesheet" type="text/css" href="'+C+'">\n')}})});A.add("writeScript",function(B){if(!readVariableType(B,"array")){B=[B]}B.forEach(function(C){if(C&&C.length>0){console.log('<script language="javascript" type="text/javascript" src="'+C+'"></script>\n')}})});A.add("setBase",function(B){if(B===undefined){B=""}if(B.length>0){this.base=this.host+"\\"+B}if(/\\+$/.test(this.base)){this.base=this.base.replace(/\\+$/,"")}});modules=new A();Response.Charset=modules.charset})();(function(){date=date?date:{};date.format=function(C,F){if(Object.prototype.toString.call(C).split(" ")[1].toLowerCase().replace("]","")!=="date"){C=new Date(C)}var B=C,L=(B.getFullYear()).toString(),K=B.getMonth(),G=(K+1).toString(),A=(B.getDate()).toString(),M=(B.getHours()).toString(),D=(B.getMinutes()).toString(),H=(B.getSeconds()).toString(),I,J;var E=["January","February","March","April","May","June","July","August","September","October","November","December"];G=G.length===1?"0"+G:G;I=A;A=A.length===1?"0"+A:A;M=M.length===1?"0"+M:M;D=D.length===1?"0"+D:D;H=H.length===1?"0"+H:H;return F.replace(/y/g,L).replace(/m/g,G).replace(/d/g,A).replace(/h/g,M).replace(/i/g,D).replace(/s/g,H).replace(/D/g,I).replace(/M/g,E[K])}})();(function(){task=new Class();task.add("value",function(A){if(A){this._value=A;return this}else{return this._value}});task.add("_value",null);task.add("status",true);task.add("then",function(B){if(this.status&&!this._stop){if(typeof B==="function"){var A=B.call(this,this._value);if(A){this._value=A}}}return this});task.add("fail",function(B){if(!this.status&&!this._stop){if(typeof B==="function"){var A=B.call(this,this._value);if(A){this._value=A}}}return this});task.add("resolve",function(){this.status=true;return this});task.add("reject",function(){this.status=false;return this});task.add("stop",function(){this._stop=true;return this});task.add("change",function(B,A){this.contexts.path=B&&B.length>0?B:this.contexts.path;this.contexts.type=A===undefined||A===null?this.contexts.type:A})})();(function(){var A=new ActiveXObject("Scripting.FileSystemObject");var B=new Class(function(D,C){this.contexts={path:D,type:!!C};this.object=A});B.add("exist",function(){return this.then(function(){var C=this.contexts.type?A.FolderExists(this.contexts.path):A.FileExists(this.contexts.path);if(C){this.resolve()}else{this.reject()}})});B.add("unExist",function(){return this.then(function(){var C=this.contexts.type?A.FolderExists(this.contexts.path):A.FileExists(this.contexts.path);if(C){this.reject()}else{this.resolve()}})});B.add("create",function(C){return this.then(function(){if(this.contexts.type){A.CreateFolder(this.contexts.path);if(A.FolderExists(this.contexts.path)){this.resolve()}else{this.reject()}}else{var D=new ActiveXObject("Adodb.Stream");D.Type=2;D.Mode=3;D.Open();D.Charset=modules.charset;D.Position=D.Size;D.WriteText=C;D.SaveToFile(this.contexts.path,2);D.Close();if(A.FileExists(this.contexts.path)){this.resolve()}else{this.reject()}}})});B.add("write",function(C){return this.then(function(){try{var D=A.OpenTextFile(this.contexts.path,8,true);D.WriteLine(C);D.Close();this.resolve()}catch(E){this.reject()}})});B.add("getDir",function(){return this.then(function(){this.resolve();if(this.contexts.type){return this.contexts.path.replace(/\\$/,"")}else{if(/^\w:\\.+$/.test(this.contexts.path)){return this.contexts.path.split("\\").slice(0,-1).join("\\")}else{return this.contexts.path.split("/").slice(0,-1).join("/")}}})});B.add("autoCreate",function(C){return this.then(function(){var D=this.value(),G="";if(this.contexts.type){G=this.contexts.path}else{this.getDir();G=this.value()}G=G.replace(/\\$/,"");var F=Server.MapPath("/"),E=G.replace(F,""),I=E.replace(/^\\/,"").split("\\");for(var H=0;H<I.length;H++){F+="\\"+I[H];if(!A.FolderExists(F)){A.CreateFolder(F)}}this.value(D);if(!this.contexts.type){this.create(C)}else{this.exist()}})});B.add("dirs",function(D){var C=this;return this.then(function(){if(this.contexts.type){var F=A.GetFolder(this.contexts.path),I=F.SubFolders,G=new Enumerator(I),H=[];for(;!G.atEnd();G.moveNext()){var E=G.item().Name;if(typeof D==="function"){E=D.call(this,E)||E}H.push(E)}this.value(H);this.resolve()}else{this.reject()}})});B.add("files",function(){return this.then(function(){if(this.contexts.type){var D=A.GetFolder(this.contexts.path),G=D.Files,E=new Enumerator(G),F=[];for(;!E.atEnd();E.moveNext()){var C=E.item().Name;if(typeof callback==="function"){C=callback.call(this,C)||C}F.push(C)}this.value(F);this.resolve()}else{this.reject()}})});B.add("remove",function(){return this.then(function(){if(this.contexts.type){A.DeleteFolder(this.contexts.path)}else{A.DeleteFile(this.contexts.path)}this.unExist()})});B.add("move",function(C){return this.then(function(){if(!this.contexts.type){A.MoveFile(this.context.path,C)}else{A.MoveFolder(this.context.path,C)}this.unExist().then(function(){this.change(C).exist()})})});B.add("copy",function(C){return this.then(function(){if(!this.contexts.type){A.CopyFile(this.context.path,C)}else{A.CopyFolder(this.context.path,C)}this.exist().then(function(){this.change(C).exist()})})});B.add("reName",function(C){return this.then(function(){if(!this.contexts.type){A.GetFile(this.context.path).Name=C}else{A.GetFolder(this.context.path).Name=C}var D=this.getDir().value()+"\\"+C;this.unExist().then(function(){this.change(D).exist()})})});B.add("read",function(){return this.then(function(){if(this.contexts.type){this.reject()}else{try{var C=new ActiveXObject("Adodb.Stream"),E;C.Type=2;C.Mode=3;C.Open();C.Charset=modules.charset;C.Position=C.Size;C.LoadFromFile(this.contexts.path);E=C.ReadText;C.Close();this.resolve();C=null;return E}catch(D){this.reject();return""}}})});B.add("readBinary",function(){return this.then(function(){if(this.contexts.type){this.reject()}else{var C=new ActiveXObject("Adodb.Stream"),D;C.Type=1;C.Open();C.LoadFromFile(this.contexts.path);D=C.Read(-1);C.Close();this.resolve();C=null;return D}})});B.add("saveBinary",function(C){return this.then(function(){if(this.contexts.type){this.reject()}else{var D=new ActiveXObject("Adodb.Stream");D.Type=1;D.Open();D.Write(this._value);D.Position=0;D.SaveToFile(C?C:this.contexts.path,2);D.Close();if(C){if(A.FileExists(C)){this.resolve()}else{this.reject()}}else{if(A.FileExists(this.contexts.path)){this.resolve()}else{this.reject()}}D=null}})});B.extend(task);fs=function(D,C){return new B(D,C).value(D)}})();(function(){var D=function(O){var N=O.replace(modules.host,"");if(/^\\/.test(N)){N=N.replace(/^\\/,"")}var M=N.split("\\"),L=M.indexOf("..");if(L>-1){L--;if(L<0){L=0;M.splice(0,1)}else{M.splice(L,2)}return D(modules.host+"\\"+M.join("\\"))}else{return modules.host+"\\"+M.join("\\")}};var I=function(O,N){if(/^\w:\\.+$/.test(O)){return O}if(modules.maps[O]){O=modules.maps[O]}O=O.replace(/\//g,"\\");var P=modules.host,M=modules.base,L=N;if(/^\\/.test(O)){O=P+O}else{if(/^\.\\/.test(O)){O=L+"\\"+O.replace(/^\.\\/,"")}else{if(/^\.\.\\/.test(O)){O=D(L+"\\"+O)}else{if(/^\:/.test(O)){O=M+"\\"+O.replace(/^\:/,"").replace(/^\\/,"")}else{O=L+"\\"+O.replace(/^\.\\/,"")}}}}return O};var K=function(M,L){var N=I(M,L);if(!/\.asp$/i.test(N)&&!/\.js$/i.test(N)&&!/\.json$/i.test(N)){N+=".js"}return N};var G=function(){this.__filename=null;this.__dirname=null;this.exports=function(){}};var C=function(L,M){return function(){var N=arguments;return L.apply(M,N)}};function A(L){if(!L||L.length===0){return""}var M="%",N="";L.split("<"+M).forEach(function(Q){var O=Q.indexOf(M+">");if(O>-1){var P=B(Q.substring(O+2));N+=(/^\=/.test(Q)?";Response.Write("+Q.substring(1,O)+");":Q.substring(0,O))+P}else{N+=B(Q)}});return N}function B(L){if(L.length>0){return';Response.Write("'+H(L)+'");'}else{return""}}function H(L){return L.replace(/\\/g,"\\\\").replace(/\"/g,'\\"').replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\s/g," ").replace(/\t/g,"\\t")}function F(L){var M=new G();M.__filename=L;M.__dirname=M.__filename.split("\\").slice(0,-1).join("\\");M.contrast=function(N){return I(N,this.__dirname)};M.resolve=function(N){return K(N,this.__dirname)};M.include=function(O,N){new E(this.contrast(O),N)};M.require=function(N){if(modules.maps[N]&&modules.maps[N].length>0){N=modules.maps[N]}else{N=fs(modules.base+"\\tron_modules\\"+N.replace(/\//g,"\\")+"\\index.js").exist().then(function(O){modules.maps[N]=O}).fail(function(O){return N}).value()}return new J(this.resolve(N))};return M}var J=new Class(function(L){this.AbsoluteModulePath=L;this.ServerScriptContent="";return this.compile()});J.add("read",function(){var L=this;fs(this.AbsoluteModulePath).exist().read().then(function(M){if(/\.json/i.test(L.AbsoluteModulePath)){L.ServerScriptContent="module.exports = "+M+";"}else{if(/\.asp/i.test(L.AbsoluteModulePath)){L.ServerScriptContent=A(L.ServerScriptContent)}else{L.ServerScriptContent=M}}}).fail(function(){L.ServerScriptContent=""})});J.add("packageServerScriptContent",function(){var L=["return function (require, exports, module, include, __filename, __dirname, contrast, resolve){",this.ServerScriptContent,"};"].join(" ");return(new Function(L))()});J.add("compile",function(){if(modules.exports[this.AbsoluteModulePath]){return modules.exports[this.AbsoluteModulePath].exports}else{this.read();var L=this.packageServerScriptContent();var M=F(this.AbsoluteModulePath);L(C(M.require,M),M.exports,M,C(M.include,M),M.__filename,M.__dirname,C(M.contrast,M),C(M.resolve,M));modules.exports[this.AbsoluteModulePath]=M;return modules.exports[this.AbsoluteModulePath].exports}});var E=new Class(function(L,M){this.AbsoluteModulePath=L;this.ServerScriptContent="";this.ServerAnyArguments=M||null;this.compile()});E.add("read",function(){var L=this;fs(this.AbsoluteModulePath).exist().then(function(M){if(/\.asp$/i.test(M)){this.resolve()}else{this.reject()}}).read().then(function(M){L.ServerScriptContent=M}).fail(function(){L.ServerScriptContent=""})});E.add("compile",function(){this.read();var P=A(this.ServerScriptContent);var Y=[],X=[];if(this.ServerAnyArguments){for(var L in this.ServerAnyArguments){Y.push(L);X.push(this.ServerAnyArguments[L])}}var N=["require","include","__filename","__dirname","contrast","resolve"],W=this.AbsoluteModulePath.split("\\").slice(0,-1).join("\\");var R=function(Z){return I(Z,W)};var S=function(Z){return K(Z,W)};var M=function(Z){return new J(S(Z))};var O=this.AbsoluteModulePath;var V=W;var Q=function(a,Z){new E(R(a),Z)};Y=Y.concat(N);X=X.concat([M,Q,O,__dirname,R,S]);var U=["return function ("+Y.join(", ")+") { ",P,"};"].join("\n"),T=(new Function(U))();T.apply(this,X)});(function(){var L=F(__filename);__filename=L.__filename;__dirname=L.__dirname;require=C(L.require,L);exports=L.exports;module=L;contrast=C(L.contrast,L);resolve=C(L.resolve,L);include=C(L.include,L)})()})();(function(){var B=new Class(function(){this.req={}});B.add("createServer",function(J,F){var D={query:{},form:{}},G=C(Request.QueryString),H=C(Request.Form),E,I;for(i=0;i<G.length;i++){E=C(Request.QueryString(G[i]),F);D.query[G[i]]=(E.length===1?E[0]:(E.length===0?"":E))}for(i=0;i<H.length;i++){E=C(Request.Form(H[i]),F);D.form[H[i]]=(E.length===1?E[0]:(E.length===0?"":E))}if(typeof J==="function"){I=J.call(this,D)}this.req=D;return I?I:D});B.add("query",function(D){var E=C(Request.QueryString(D),callback);if(E.length===0){return}return E.length===1?E[0]:(E.length===0?"":E)});B.add("form",function(D){var E=C(Request.Form(D),callback);if(E.length===0){return}return E.length===1?E[0]:(E.length===0?"":E)});function C(E,H){var D=new Enumerator(E),G=[];for(;!D.atEnd();D.moveNext()){if(typeof H==="function"){var F=H(D.item());if(F){G.push(F)}}else{G.push(D.item())}}return G}var A=new Class(function(){this.object=new ActiveXObject("Microsoft.XMLHTTP")});A.add("bin",function(F){var D=new ActiveXObject("Adodb.Stream"),E;D.Type=1;D.Mode=3;D.Open;D.Write(F);D.Position=0;D.Type=2;if(modules.charset){D.Charset=modules.charset}E=D.ReadText;D.Close;return E});A.add("param",function(D){if(!D||D===null||D===false||D===undefined){return null}if(typeof D==="object"){var F=[],E;for(E in D){F.push(E+"="+D[E])}return F.join("&")}else{return D}});A.add("save",function(D,F){var E=new ActiveXObject("Adodb.Stream");E.Type=1;E.Mode=3;E.Open();E.Position=0;E.Write(D);E.SaveToFile(F,2);E.Close();E=null});A.add("send",function(F){var E=this,D;if(!F.method){F.method="get"}if(/^get$/i.test(F.method)&&F.data){var G=this.param(F.data);if(G!==null&&F.url.indexOf("?")>-1){F.url+="&"+G}else{F.url+="?"+G}F.data=null}this.object.open(F.method.toUpperCase(),F.url,false);if(F.method.toUpperCase()==="POST"){this.object.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}this.object.onreadystatechange=function(){if(E.object.readyState===4){if(E.object.status===200){if(typeof F.success==="function"){D=F.success.call(E,E.object)}}}};this.object.send(this.param(F.data));if(D){return D}else{return this}});A.add("get",function(E,F,D){return this.send({url:E,data:F,success:function(H){var G=this.bin(H.responseBody);if(typeof D==="function"){G=D.call(this,G,H)}return G}})});A.add("post",function(E,F,D){return this.send({url:E,data:F,success:function(H){var G=this.bin(H.responseBody);if(typeof D==="function"){G=D.call(this,G,H)}return G},method:"post"})});A.add("getBinary",function(E,F,D){return this.send({url:E,data:F,success:function(H){var G=H.responseBody;if(typeof D==="function"){G=D.call(this,G,H)}return G}})});A.add("getJSON",function(D,E){return this.get(D,E,function(F){return JSON.parse(F)})});A.add("postJSON",function(D,E){return this.post(D,E,function(F){return JSON.parse(F)})});A.add("SaveFile",function(D,F,E){if(!E){E=F;F={}}this.getBinary(D,F,function(G){this.save(G,E)})});http=new B();ajax=A})();(function(){var A="ADODB.CONNECTION";connect=new Class(function(J,K){this.object=new ActiveXObject(A);this.connectString=[];if(J==="access"){this.Access(K)}else{if(J==="mssql"){this.MsSql(K)}}for(var I=0;I<this.connectString.length;I++){try{this.object.Open(this.connectString[I]);break}catch(L){}}return this.object});connect.add("Access",function(I){this.connectString=["provider=Microsoft.jet.oledb.4.0;data source="+I,"driver={microsoft access driver (*.mdb)};dbq="+I]});connect.add("MsSql",function(I){var J=[];J.push(["Provider=sqloledb","Data Source="+I.netserver,"Initial Catalog="+I.access,"User Id="+I.username,"Password="+I.password,""].join(";"));J.push(["Driver={SQL Server}","Server="+I.netserver,"Database="+I.access,"Uid="+I.username,"Pwd="+I.password,""].join(";"));this.connectString=J});var E="ADODB.RECORDSET";var C={};dbo=new Class(function(I,J){if(C[I]){return C[I]}this.tables=I;this.conn=J;this.object=new ActiveXObject(E);this.fields=[];this.length=0;this.resetSQL();this.table(I);C[I]=this});dbo.add("getFields",function(){this.object.Open("SELECT TOP 0 * FROM "+this.tables,this.conn,1,1);for(var I=0;I<this.object.fields.count;I++){this.fields.push(this.object.fields(I).name)}this.length=this.fields.length;this.object.Close();return this});dbo.add("create",function(){this.selectAll();this.open(2);this.object.AddNew();return this});dbo.add("set",function(I,J){if(!J&&typeof I==="object"){for(var K in I){this.object(K)=I[K]}}else{this.object(I)=J}return this});dbo.add("save",function(){this.object.Update();return this});dbo.add("remove",function(){this.object.Delete();return this});dbo.add("where",function(I){this.sql.where=I;return this});dbo.add("open",function(I){this.gruntSQL();this.object.Open(this.sql.text,this.conn,1,I?I:1);return this});dbo.add("close",function(){try{this.object.Close()}catch(I){}return this});dbo.add("exec",function(I,J){if(!J&&readVariableType(I,"string")){this.conn.Execute(I)}else{if(!I){this.gruntSQL();this.conn.Execute(this.sql.text)}else{if(!this.object.Bof&&!this.object.Eof){typeof I==="function"&&I.call(this,this.object)}else{typeof J==="function"&&J.call(this,this.object)}}}return this});dbo.add("find",function(J,I){this.open(I).exec(function(K){J.call(this,this.object)});this.object.Close();return this});dbo.add("each",function(I){return this.exec(function(J){var K=0;J.MoveFirst();while(!J.Eof){typeof I==="function"&&I.call(this,J,K);J.MoveNext();K++}})});dbo.add("rows",function(){try{var I=this.object.GetRows().toArray();return H(I,this.object.Fields.Count)}catch(J){return[]}});var G=new Class();G.add("resetSQL",function(){this.sql={};this.sql.where="";return this});G.add("top",function(I){if(I&&!isNaN(I)){this.sql.top=I}return this});G.add("selectAll",function(){this.sql.selectors=["*"];return this});G.add("select",function(){if(!this.sql.selectors){this.sql.selectors=[]}var I=Array.prototype.slice.call(arguments,0);this.sql.selectors=F(this.sql.selectors.concat(I));return this});G.add("where",function(I){this.sql.where=I;return this});G.add("table",function(I){this.sql.table=I;return this});G.add("and",function(K,J,I){if(this.sql.where.length===0){this.sql.where+=B(K,J,I)}else{this.sql.where+=" AND "+B(K,J,I)}return this});G.add("or",function(K,J,I){if(this.sql.where.length===0){this.sql.where+=B(K,J,I)}else{this.sql.where+=" OR "+B(K,J,I)}return this});G.add("ands",function(K){var I=new Class();I.extend(G);var J=new I();J.resetSQL();if(typeof K==="function"){K.call(J)}J.gruntSQL();if(this.sql.where.length===0){this.sql.where+="("+J.sql.text+")"}else{this.sql.where+=" AND ("+J.sql.text+")"}return this});G.add("ors",function(K){var I=new Class();I.extend(G);var J=new I();J.resetSQL();if(typeof K==="function"){K.call(J)}J.gruntSQL();if(this.sql.where.length===0){this.sql.where+="("+J.sql.text+")"}else{this.sql.where+=" OR ("+J.sql.text+")"}return this});G.add("asc",function(I){if(!this.sql.order||this.sql.order.length===0){this.sql.order=[]}this.sql.order.push(I+" ASC");return this});G.add("desc",function(I){if(!this.sql.order||this.sql.order.length===0){this.sql.order=[]}this.sql.order.push(I+" DESC");return this});G.add("gruntSQL",function(){var I=[];if(this.sql.table&&this.sql.table.length>0&&this.sql.selectors&&this.sql.selectors.length>0){I.push("SELECT");if(this.sql.top&&this.sql.top>0){I.push("TOP "+this.sql.top)}if(this.sql.selectors&&this.sql.selectors.length>0){I.push(this.sql.selectors.join(","))}I.push("FROM "+this.sql.table);if(this.sql.where.length>0){I.push("WHERE");I.push(this.sql.where)}if(this.sql.order&&this.sql.order.length>0){I.push("ORDER BY");I.push(this.sql.order.join(","))}}else{I.push(this.sql.where)}this.sql.text=I.join(" ");return this});function F(J){var N={};var K=[];for(var L=0,I=J.length;L<I;L++){var M=J[L];if(N[M]!==1){N[M]=1;K.push(M)}}return K}function B(K,J,I){if(!I){I="="}I=I.toLowerCase();if(I==="in"){if(!readVariableType(J,"array")){J=[J]}var L=[];for(var M=0;M<J.length;M++){if(readVariableType(J[M],"string")){L.push("'"+J[M]+"'")}else{L.push(J[M])}}return K+" IN ("+L.join(",")+")"}else{if(readVariableType(J,"string")){J="'"+J+"'"}return K+I+J}}function D(I,J){return function(){var K=arguments;return I.apply(J,K)}}function H(J,K){var I=J.length/K,O=[],N;for(var L=0;L<I;L++){O[L]=new Array();N=L*K;for(var M=0;M<K;M++){O[L][M]=J[N+M]}}return O}dbo.extend(G)})();(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());%>